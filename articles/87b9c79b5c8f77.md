---
title: "Google Sheetsã§fill blank"
emoji: "ğŸ"
type: "tech"
topics:
  - "googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆ"
  - "lambdaé–¢æ•°"
published: true
published_at: "2023-09-01 17:59"
---

# Google Sheetsé–¢æ•°: fill_blank_by_upper

Google Sheetsã§ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ã£ã¦ã„ã‚‹ã¨ã€æ¬ æå€¤ã‚„ç©ºç™½ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ç‰¹ã«ã‚»ãƒ«çµåˆã‚’ç”¨ã„ãŸè¡¨ã§ã¯ã€å€¤ã¯å·¦ä¸Šã«ã—ã‹å…¥ã‚‰ãªã„ãŸã‚ä¸‹ã®ã‚ˆã†ãªæ¬ æå€¤ã‚’å«ã‚€è¡¨ã¨ãªã£ã¦ã—ã¾ã„ã¾ã™ã€‚

|     | A    |    B |
| :--- | :--- | :--- |
| 1    | red    | apple |
| 2    |      | strawberry |
| 3    | yellow    | banana |
| 4    |      | lemon |
| 5    | green    | asparagus |

ã“ã®`fill_blank_by_upper`é–¢æ•°ã¯ã€ã‚«ãƒ©ãƒ å†…ã®æ¬ æå€¤ã‚’ãã®ã‚«ãƒ©ãƒ ã®ç›´ä¸Šã®éæ¬ æå€¤ã§åŸ‹ã‚ã‚‹ãŸã‚ã®é–¢æ•°ã§ã™ã€‚

## å¯¾è±¡èª­è€…

Google Sheetsã§ä¸Šè¨˜ã®ã‚ˆã†ãªæ¬ æå€¤å…¥ã‚Šã®ãƒ‡ãƒ¼ã‚¿ã‚’lambdaé–¢æ•°ã§å‡¦ç†ã—ãŸã„ã¨æ€ã£ã¦ã„ã‚‹æ–¹

## ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿

| ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ | èª¬æ˜ | 
| :-- | :-- |
| `range` | åŸ‹ã‚ã‚‹ã‚»ãƒ«ã®ç¯„å›²ã€‚ |

## ä¾‹

```js
=fill_blank_by_upper(A1:B5)
```

### å…ƒã®ãƒ‡ãƒ¼ã‚¿

|     | A    |    B |
| :--- | :--- | :--- |
| 1    | red    | apple |
| 2    |      | strawberry |
| 3    | yellow    | banana |
| 4    |      | lemon |
| 5    | green    | asparagus |

#### çµæœ

|     | A    |    B |
| :--- | :--- | :--- |
| 1    | red    | apple |
| 2    | red    | strawberry |
| 3    | yellow    | banana |
| 4    | yellow    | lemon |
| 5    | green    | asparagus |

## å®Ÿè£…

```js
lambda(
  range,
  let(
    fill_col_blank,lambda(
      col,
      scan(
        ,
        col,
        lambda(
          prev,
          current,
          if(
            isBlank(current),
            prev,
            current
          )
        )
      )
    ),
    byCol(range,fill_col_blank)
  )
)
```

ã“ã®é–¢æ•°ã®å®Ÿè£…ã¯ã€lambdaã‚’ç”¨ã„ã¦ã„ã¦ã€å…·ä½“çš„ãªå‹•ä½œã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

1. `fill_col_blank`ã§ã¯1åˆ—ã®ãƒ‡ãƒ¼ã‚¿ã‚’å¯¾è±¡ã«æ¬ æå€¤ã‚’åŸ‹ã‚ã¾ã™ã€‚
2. `scan`é–¢æ•°ã¯ã€ã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¸Šã‹ã‚‰ä¸‹ã¸ã¨é †ã«èµ°æŸ»ã—ã€å‰å›ã®å€¤ï¼ˆ`prev`ï¼‰ã¨ç¾åœ¨ã®å€¤ï¼ˆ`current`ï¼‰ã‚’æ¯”è¼ƒã—ã¾ã™ã€‚
3. `if(isBlank(current), prev, current)`ã®éƒ¨åˆ†ã§ã€ç¾åœ¨ã®ã‚»ãƒ«ã®å€¤ãŒç©ºç™½ï¼ˆæ¬ æå€¤ï¼‰ã§ã‚ã‚Œã°ã€å‰å›ã®å€¤ï¼ˆç›´ä¸Šã®ã‚»ãƒ«ã®å€¤ï¼‰ã‚’è¿”ã—ã€ãã†ã§ãªã‘ã‚Œã°ç¾åœ¨ã®å€¤ã‚’è¿”ã—ã¾ã™ã€‚
4. ã“ã‚Œã‚’ã‚«ãƒ©ãƒ ã®æœ€å¾Œã¾ã§ç¹°ã‚Šè¿”ã—ã€æ¬ æå€¤ã‚’åŸ‹ã‚ãŸã‚«ãƒ©ãƒ ã®ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
5. `byCol`ã‚’ç”¨ã„ã¦å…¨ã¦ã®è¡Œã‚’å‡¦ç†ã—ã¾ã™ã€‚

åå‰ä»˜ãé–¢æ•°ã¨ã—ã¦ç™»éŒ²ã™ã‚‹å ´åˆã¯ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦`range`ã‚’ç™»éŒ²ã—ãŸä¸Šã§ã€ä»¥ä¸‹ã‚’é–¢æ•°ã®æœ¬ä½“ã¨ã—ã¦ç™»éŒ²ã—ã¦ãã ã•ã„

```js
=let(
    fill_col_blank,lambda(
      col,
      scan(
        ,
        col,
        lambda(
          prev,
          current,
          if(
            isBlank(current),
            prev,
            current
          )
        )
      )
    ),
    byCol(range,fill_col_blank)
  )
  ```
  
  ã“ã®é–¢æ•°ã‚’ç”¨ã„ã‚Œã°ã€ã‚»ãƒ«çµåˆã®ã›ã„ã§æ¬ æå€¤ãŒã‚ã‚‹è¡¨ã‚‚ç°¡å˜ã«æ‰±ã†ã“ã¨ãŒã§ãã¾ã™ã€‚